<%args>
@tags => () 
</%args>

% use lib $ENV{DOCUMENT_ROOT};
% use Shim::Tools;
% use DateTime;

% if (!($ENV{REMOTE_USER})) {
<p>Site owner? <a href=/logged-in/splash>Log In</a></p>
% }

% if (@tags) {
<p>Narrowed by:</p>
% for (@tags) {
<ul>
    <li><% $_ %></li>
</ul>
% }
% }
% else {
<p>Showing all posts.</p>
% }

% my $posts = Shim::Tools::fetch_posts();

<p>
<ul>
% for (@$posts) {
<li><a href=<% $ENV{REMOTE_USER} ? 
    "/logged-in/posts/" : 
    "/posts/" %><% $_->id %>>
    <% $_->title %>
    </a>
</li>
% }
</ul>
</p>
